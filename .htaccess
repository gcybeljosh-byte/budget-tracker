# Prevent Directory Listing
Options -Indexes

# Protect Sensitive Files (Apache 2.4 syntax)
<FilesMatch "^\.">
    Require all denied
</FilesMatch>

<FilesMatch "^(config|db)\.php$">
    Require all denied
</FilesMatch>

# Block access to logs, SQL, and MD files
<FilesMatch "\.(log|md|sql)$">
    Require all denied
</FilesMatch>

# Protect includes directory using mod_rewrite for better compatibility
RewriteEngine On
RewriteBase /

# Force HTTPS
RewriteCond %{HTTP:X-Forwarded-Proto} !https
RewriteCond %{HTTPS} off
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Block access to the includes and .git folders
RewriteRule ^includes/ - [F,L]
RewriteRule ^\.git/ - [F,L]

# Prevent directory browsing for the api folder (already covered by Options -Indexes)
# But we can add a rewrite rule to be sure
# RewriteRule ^api/$ - [F,L]
